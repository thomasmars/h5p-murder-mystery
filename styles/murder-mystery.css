.h5p-mm { font-family: system-ui, sans-serif; position: relative; }
.h5p-mm__root { padding: 12px; display: flex; justify-content: center; }

.h5p-mm__shell { width: 100%; display: flex; flex-direction: column; align-items: center; gap: 18px; padding: 6px 0 18px; box-sizing: border-box; }

.h5p-mm__select { width: 100%; display: flex; flex-direction: column; align-items: center; gap: 16px; text-align: center; }
.h5p-mm__intro { max-width: 560px; display: flex; flex-direction: column; gap: 6px; text-align: center; }
.h5p-mm__intro-title { margin: 0; font-size: 22px; font-weight: 600; color: #222a35; }
.h5p-mm__intro-lead { margin: 0; font-size: 14px; color: #5b6475; }
.h5p-mm__select-title { margin: 0; font-size: 20px; font-weight: 600; color: #283041; }
.h5p-mm__select-subtitle { margin: 0; font-size: 14px; color: #5c6475; }
.h5p-mm__select-list { width: 100%; list-style: none; padding: 0; margin: 0; display: grid; gap: 14px; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); }
.h5p-mm__select-card { width: 100%; border: 1px solid #d8dce6; border-radius: 14px; background: #fff; box-shadow: 0 14px 32px rgba(15, 20, 35, 0.12); padding: 16px; display: flex; flex-direction: column; align-items: center; gap: 10px; cursor: pointer; transition: transform 0.18s ease, box-shadow 0.18s ease; }
.h5p-mm__select-card:hover { transform: translateY(-4px); box-shadow: 0 18px 34px rgba(15, 20, 35, 0.18); }
.h5p-mm__select-img { width: 100%; max-width: 180px; border-radius: 12px; box-shadow: 0 12px 28px rgba(12, 16, 28, 0.2); }
.h5p-mm__select-name { font-size: 16px; font-weight: 600; color: #2f3643; }

.h5p-mm__panel { width: 100%; max-width: 520px; display: flex; flex-direction: column; align-items: center; gap: 14px; text-align: center; }
.h5p-mm__panel-top { width: 100%; display: flex; justify-content: space-between; align-items: center; gap: 12px; }
.h5p-mm__back { font: inherit; border: none; background: none; color: #1d48c7; cursor: pointer; display: inline-flex; align-items: center; gap: 6px; padding: 6px 0; transition: color 0.15s ease; }
.h5p-mm__back:hover { color: #123ba2; }
.h5p-mm__toolbar { display: flex; justify-content: flex-end; align-items: center; gap: 8px; }
.h5p-mm__audio-toggle { font: inherit; padding: 6px 10px; border-radius: 16px; border: 1px solid #c7ccd4; background: #f6f7fa; color: #4a5361; cursor: pointer; transition: all 0.15s ease; }
.h5p-mm__audio-toggle:hover { background: #eef2f9; }
.h5p-mm__audio-toggle.is-on { background: #1d48c7; color: #fff; border-color: #1d48c7; box-shadow: 0 4px 12px rgba(29,72,199,0.3); }
.h5p-mm__audio-toggle.is-on:hover { background: #1740b5; }
.h5p-mm__audio-status { font-size: 12px; color: #65708a; display: inline-flex; align-items: center; gap: 4px; }

.h5p-mm__portrait { display: flex; flex-direction: column; align-items: center; gap: 12px; }
.h5p-mm__portrait-img { width: clamp(200px, 90%, 360px); border-radius: 20px; box-shadow: 0 24px 48px rgba(10, 13, 24, 0.35); }
.h5p-mm__panel-name { margin: 6px 0 0; font-size: 20px; font-weight: 600; letter-spacing: 0.4px; color: #273041; }
.h5p-mm__panel-role { margin: 0 0 6px; font-size: 12px; letter-spacing: 1px; text-transform: uppercase; color: #6d7586; }

.h5p-mm__chat-box { width: 100%; max-height: 220px; min-height: 140px; overflow-y: auto; -webkit-overflow-scrolling: touch; border: 1px solid #e3e6ef; border-radius: 12px; padding: 10px; background: #fff; box-shadow: inset 0 1px 4px rgba(15, 20, 35, 0.05); }
.h5p-mm__msg { max-width: 80%; margin: 6px 0; padding: 8px 10px; border-radius: 12px; line-height: 1.3; }
.h5p-mm__msg--user { margin-left: auto; background: #e6f2ff; }
.h5p-mm__msg--assistant { margin-right: auto; background: #f0f0f0; }

.h5p-mm__chat-inputs { width: 100%; display: flex; flex-direction: column; gap: 10px; }
.h5p-mm__input { width: 100%; display: flex; gap: 8px; }
.h5p-mm__text { flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; font: inherit; }
.h5p-mm__text--chat { min-height: 64px; padding: 12px; resize: vertical; }
.h5p-mm__send, .h5p-mm__solve-btn { padding: 8px 12px; border: 1px solid #ccc; background: #fafafa; border-radius: 6px; cursor: pointer; }
.h5p-mm__solve { display: flex; gap: 8px; justify-content: center; width: 100%; max-width: 420px; margin-top: 6px; }
.h5p-mm__solution { margin-top: 12px; display: none; }
.h5p-mm__solution.is-visible { display: block; }
.h5p-mm__solution-line { margin: 6px 0; }
.h5p-mm__solution-wrong { color: #b00; margin: 0; }

.h5p-mm__ending-full { position: absolute; inset: 0; z-index: 10; display: flex; justify-content: center; align-items: center; padding: clamp(18px, 4vw, 32px); background: rgba(9, 12, 18, 0.88); backdrop-filter: blur(2px); }
.h5p-mm__ending-panel { width: min(520px, 92%); border-radius: 12px; padding: clamp(20px, 3.5vw, 30px); background: linear-gradient(165deg, rgba(15,19,31,0.95) 0%, rgba(30,39,57,0.95) 100%); box-shadow: 0 20px 48px rgba(3,7,18,0.55); display: flex; flex-direction: column; align-items: center; text-align: center; color: #f2f4f8; gap: clamp(12px, 2.2vw, 20px); position: relative; }
.h5p-mm__ending-img-wrap { width: clamp(180px, 60%, 320px); aspect-ratio: 4 / 3; border-radius: 10px; overflow: hidden; box-shadow: 0 18px 36px rgba(2,6,16,0.6); }
.h5p-mm__ending-img { width: 100%; height: 100%; object-fit: contain; object-position: center; display: block; background: rgba(6, 9, 16, 0.6); }
.h5p-mm__ending-title { font-size: clamp(18px, 3vw, 22px); letter-spacing: 1px; text-transform: uppercase; margin: 0; }
.h5p-mm__ending-text { font-size: clamp(13px, 2.2vw, 15px); line-height: 1.65; color: #d7d9e0; max-width: 420px; }
.h5p-mm__ending-text p { margin: 0 0 8px; }
